var controllers = angular.module('controllers');
controllers.controller('inspectionController', [
  '$scope',
  '$location',
  'Inspection',
  'loginService',
  'entityService',
  'inspectionService',
  function ($scope, $location, Inspection, loginService, entityService, inspectionService) {
    if (loginService.currentUserId === 0) {
      $location.path('/home');
    }
    $scope.editInspection = function (id) {
      $scope.entity = Inspection.get({ 'inspectionId': id }, function (topic, getResponseHeaders) {
        entityService.inspectionToEdit = $scope.entity;
        $location.path('/editInspection');
      });
    };
    $scope.deleteInspection = function (id) {
      Inspection.deleteInspection({ 'id': id }, function () {
        inspectionService.getMyInspections($scope.successCallback, $scope.errorCallback);
      });
    };
    $scope.successCallback = function (data) {
      $scope.reports = data;
      $location.path('/inspections');
    };
    $scope.errorCallback = function (message) {
      $scope.errorMessage = message;
    };
    if (loginService.currentUserId !== 0) {
      inspectionService.getMyInspections($scope.successCallback, $scope.errorCallback);
    }
  }
]);
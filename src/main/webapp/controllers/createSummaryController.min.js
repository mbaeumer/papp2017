var controllers=angular.module("controllers");
controllers.controller("createSummaryController",["$scope","$http","Inspection","ActivityType","Category","Area","User","$location","inspectionService","entityService","datePickerService","loginService","fileService","filterService",function(a,r,g,h,k,l,m,e,n,p,f,q,s,d){a.entity={inspectionDate:(new Date).toString("MM/dd/yyyy"),guard:"",area:"",startHour:"00",startMinute:"00",stopHour:"00",stopMinute:"00",fined:"",activity:"",category:""};0===q.currentUserId&&e.path("/home");a.from=f.createConfig({minDate:"2010-01-01",
maxDate:"2017-01-01"});a.to=f.createConfig({minDate:"2010-01-01",maxDate:"2017-01-01"});a.title="Registrera ny rapport";a.hours=[{value:"00"},{value:"01"},{value:"02"},{value:"03"},{value:"04"},{value:"05"},{value:"06"},{value:"07"},{value:"08"},{value:"09"},{value:"10"},{value:"11"},{value:"12"},{value:"13"},{value:"14"},{value:"15"},{value:"16"},{value:"17"},{value:"18"},{value:"19"},{value:"20"},{value:"21"},{value:"22"},{value:"23"}];a.minutes=[{value:"00"},{value:"05"},{value:"10"},{value:"15"},
{value:"20"},{value:"25"},{value:"30"},{value:"35"},{value:"40"},{value:"45"},{value:"50"},{value:"55"}];a.selectedTravelHour=a.hours[0];a.selectedTravelMinute=a.minutes[0];a.selectedStartHour=a.hours[0];a.selectedStartMinute=a.minutes[0];a.selectedStopHour=a.hours[0];a.selectedStopMinute=a.minutes[0];a.activitytypes=h.query(function(){a.selectedActivity=a.activitytypes[0]});a.categorytypes=k.query(function(){a.selectedCategory=a.categorytypes[0]});a.rawAreas=l.query(function(){a.composedAreas=[];
for(var b=0;b<a.rawAreas.length;b++){var c={id:0,code:0,name:""};c.id=a.rawAreas[b].id;c.name=a.rawAreas[b].name;c.code=a.rawAreas[b].code;c.value=a.rawAreas[b].code+" "+a.rawAreas[b].name;a.composedAreas.push(c)}a.selectedArea=a.composedAreas[0]});a.rawUsers=m.query(function(){a.composedUsers=[];for(var b=0;b<a.rawUsers.length;b++){var c={id:0,usercode:0,name:""};c.id=a.rawUsers[b].id;c.name=a.rawUsers[b].name;c.usercode=a.rawUsers[b].usercode;c.value=a.rawUsers[b].usercode+" "+a.rawUsers[b].name;
a.composedUsers.push(c)}a.selectedUser=a.composedUsers[0]});a.saveSummary=function(){var b=new g;b.inspectionDate=new Date(a.entity.inspectionDate);b.travel=new Date(b.inspectionDate.getTime());b.startTime=new Date(b.inspectionDate.getTime());b.endTime=new Date(b.inspectionDate.getTime());b.travel=b.travel.addHours(parseInt(a.selectedTravelHour.value));b.travel=b.travel.addMinutes(parseInt(a.selectedTravelMinute.value));b.startTime=b.startTime.addHours(parseInt(a.selectedStartHour.value));b.startTime=
b.startTime.addMinutes(parseInt(a.selectedStartMinute.value));b.endTime=b.endTime.addHours(parseInt(a.selectedStopHour.value));b.endTime=b.endTime.addMinutes(parseInt(a.selectedStopMinute.value));b.fined=parseInt(a.entity.fined);b.warnings=0;b.obliterated=0;parseInt(a.entity.obliterated);b.companyCode=p.currentCompanyCode;b.guard={id:a.selectedUser.id,name:a.selectedUser.name};b.activityType={id:a.selectedActivity.id,description:a.selectedActivity.description};b.category={id:a.selectedCategory.id,
description:a.selectedCategory.description};b.area={id:a.selectedArea.id,name:a.selectedArea.name};n.createInspection(b,a.successCallback,a.errorCallback)};a.abortReportCreation=function(){d.startDate="";d.endDate="";e.path("/summary")};a.successCallback=function(){d.startDate="";d.endDate="";e.path("/summary")};a.errorCallback=function(b){a.errorMessage=b}}]);

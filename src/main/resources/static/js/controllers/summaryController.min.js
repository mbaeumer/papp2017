var controllers=angular.module("controllers");
controllers.controller("summaryController",["$scope","$location","Inspection","entityService","fileService","loginService","Summary","metaSummaryService","filterService",function(a,g,h,m,k,n,p,l,f){0===n.currentUserId&&g.path("/home");a.reports=p.query(function(){});a.dateRange="";a.startDate="";a.endDate="";a.isActive=function(a){return a===g.path()};a.editSummary=function(b){a.entity=h.get({inspectionId:b},function(b,d){m.inspectionToEdit=a.entity;g.path("/editSummary")})};a.dateFilter=function(b){return""!=
a.startDate&&""!=a.endDate?b.inspectionDate>=a.startDate&&b.inspectionDate<a.endDate:!0};a.deleteSummary=function(b){h.deleteInspection({id:b},function(){a.reports=h.query()})};a.setDateFilter=function(b){var c=(new Date).toString("MM/dd/yyyy"),d=new Date(c),e=new Date;"today"===b?(a.startDate=new Date(d.getTime()),e=new Date(d.getTime()),a.endDate=(new Date(e.addDays(1))).addMinutes(-1)):"yesterday"===b?(d=d.addDays(-1),a.startDate=new Date(d.getTime()),a.endDate=(new Date((new Date(d.getTime())).addDays(1))).addMinutes(-1)):
"past_week"===b?(b=new Date(c),c=new Date(b.getDay()),d=new Date(b.getDate()-c+(0==c?-6:1)),e=new Date(b.getTime()),b=new Date(b.setDate(d)),a.startDate=new Date(b),a.endDate=(new Date(e.addDays(8-c))).addMinutes(-1),a.startDate=(new Date(a.startDate.getTime())).addDays(-7),a.endDate=(new Date(a.endDate.getTime())).addDays(-7)):"this_week"===b?(b=new Date(c),c=new Date(b.getDay()),d=new Date(b.getDate()-c+(0==c?-6:1)),e=new Date(b.getTime()),b=new Date(b.setDate(d)),a.startDate=new Date(b),a.endDate=
(new Date(e.addDays(8-c))).addMinutes(-1)):"past_month"===b?(b=new Date(c),e=new Date(b.getFullYear(),b.getMonth()-1,1),b=new Date(b.getFullYear(),b.getMonth(),0),a.startDate=e,a.endDate=b.addDays(1)):"this_month"===b?(b=new Date(c),e=new Date(b.getFullYear(),b.getMonth(),1),b=new Date(b.getFullYear(),b.getMonth()+1,0),a.startDate=e,a.endDate=b.addDays(1)):(a.startDate="",a.endDate="");k.startDate=a.startDate.toString("MM/dd/yyyy");k.endDate=a.endDate.toString("MM/dd/yyyy");f.startDate=a.startDate.toString("MM/dd/yyyy");
f.endDate=a.endDate.toString("MM/dd/yyyy");a.metaSummary=l.getMetaSummary(a.successCallback,a.errorCallback)};a.successCallback=function(b){a.metaSummary=b;f.startDate="";f.endDate=""};a.errorCallback=function(a){};a.metaSummary=l.getMetaSummary(a.successCallback,a.errorCallback)}]);

var controllers=angular.module("controllers");
controllers.controller("editSummaryController",["$scope","$http","$location","Inspection","loginService","User","Area","Category","ActivityType","entityService","inspectionService","datePickerService","fileService",function(a,m,k,e,l,n,p,q,r,d,s,f,g){a.entity=d.inspectionToEdit;a.entity.inspectionDate=(new Date(a.entity.inspectionDate)).toString("MM/dd/yyyy");a.from=f.createConfig({minDate:"2010-01-01",maxDate:"2017-01-01"});a.to=f.createConfig({minDate:"2010-01-01",maxDate:"2017-01-01"});a.title=
"Redigera rapport";0===l.currentUserId&&k.path("/home");a.hours=[{id:0,value:"00"},{id:1,value:"01"},{id:2,value:"02"},{id:3,value:"03"},{id:4,value:"04"},{id:5,value:"05"},{id:6,value:"06"},{id:7,value:"07"},{id:8,value:"08"},{id:9,value:"09"},{id:10,value:"10"},{id:11,value:"11"},{id:12,value:"12"},{id:13,value:"13"},{id:14,value:"14"},{id:15,value:"15"},{id:16,value:"16"},{id:17,value:"17"},{id:18,value:"18"},{id:19,value:"19"},{id:20,value:"20"},{id:21,value:"21"},{id:22,value:"22"},{id:23,value:"23"}];
a.minutes=[{value:"00"},{value:"05"},{value:"10"},{value:"15"},{value:"20"},{value:"25"},{value:"30"},{value:"35"},{value:"40"},{value:"45"},{value:"50"},{value:"55"}];e=new Date(a.entity.travel);m=e.getHours();e=e.getMinutes();d=new Date(a.entity.startTime);l=d.getHours();d=d.getMinutes();var h=new Date(a.entity.endTime);f=h.getHours();h=h.getMinutes();a.selectedTravelHour=a.hours[m];a.selectedTravelMinute=a.minutes[e/5];a.selectedStartHour=a.hours[l];a.selectedStartMinute=a.minutes[d/5];a.selectedStopHour=
a.hours[f];a.selectedStopMinute=a.minutes[h/5];a.activitytypes=r.query(function(){a.selectedActivity=a.activitytypes[a.entity.activityType.id-1]});a.categorytypes=q.query(function(){a.selectedCategory=a.categorytypes[a.entity.category.id-1]});a.rawAreas=p.query(function(){a.composedAreas=[];for(var b=0;b<a.rawAreas.length;b++){var c={id:0,code:0,name:""};c.id=a.rawAreas[b].id;c.name=a.rawAreas[b].name;c.code=a.rawAreas[b].code;c.value=a.rawAreas[b].code+" "+a.rawAreas[b].name;a.composedAreas.push(c)}a.selectedArea=
a.composedAreas[a.entity.area.id-1]});a.rawUsers=n.query(function(){a.composedUsers=[];for(var b=0;b<a.rawUsers.length;b++){var c={id:0,usercode:0,name:""};c.id=a.rawUsers[b].id;c.name=a.rawUsers[b].name;c.usercode=a.rawUsers[b].usercode;c.value=a.rawUsers[b].usercode+" "+a.rawUsers[b].name;a.composedUsers.push(c)}a.selectedUser=a.composedUsers[a.entity.guard.id-1]});a.saveSummary=function(){var b=a.entity;b.inspectionDate=new Date(a.entity.inspectionDate);b.travel=new Date(b.inspectionDate.getTime());
b.startTime=new Date(b.inspectionDate.getTime());b.endTime=new Date(b.inspectionDate.getTime());b.travel=b.travel.addHours(parseInt(a.selectedTravelHour.value));b.travel=b.travel.addMinutes(parseInt(a.selectedTravelMinute.value));b.startTime=b.startTime.addHours(parseInt(a.selectedStartHour.value));b.startTime=b.startTime.addMinutes(parseInt(a.selectedStartMinute.value));b.endTime=b.endTime.addHours(parseInt(a.selectedStopHour.value));b.endTime=b.endTime.addMinutes(parseInt(a.selectedStopMinute.value));
b.fined=parseInt(a.entity.fined);b.warnings=0;b.obliterated=0;parseInt(a.entity.obliterated);b.guard={id:a.selectedUser.id,name:a.selectedUser.name};b.activityType={id:a.selectedActivity.id,description:a.selectedActivity.description};b.category={id:a.selectedCategory.id,description:a.selectedCategory.description};b.area={id:a.selectedArea.id,name:a.selectedArea.name};s.editInspection(b,a.successCallback,a.errorCallback)};a.abortReportCreation=function(){g.startDate="";g.endDate="";k.path("/summary")};
a.successCallback=function(){g.startDate="";g.endDate="";k.path("/summary")};a.errorCallback=function(b){a.errorMessage=b}}]);

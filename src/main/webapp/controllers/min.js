var controllers=angular.module("controllers");
controllers.controller("editInspectionController",["$scope","$http","$location","Inspection","loginService","User","entityService","Area","inspectionService","datePickerService","areaService",function(a,k,f,g,h,p,d,l,m,c,n){a.entity=d.inspectionToEdit;a.entity.inspectionDate=(new Date(a.entity.inspectionDate)).toString("MM/dd/yyyy");a.from=c.createConfig({minDate:"2010-01-01",maxDate:"2017-01-01"});a.to=c.createConfig({minDate:"2010-01-01",maxDate:"2017-01-01"});a.title="Redigera rapport";0===h.currentUserId&&
f.path("/home");a.hours=[{id:0,value:"00"},{id:1,value:"01"},{id:2,value:"02"},{id:3,value:"03"},{id:4,value:"04"},{id:5,value:"05"},{id:6,value:"06"},{id:7,value:"07"},{id:8,value:"08"},{id:9,value:"09"},{id:10,value:"10"},{id:11,value:"11"},{id:12,value:"12"},{id:13,value:"13"},{id:14,value:"14"},{id:15,value:"15"},{id:16,value:"16"},{id:17,value:"17"},{id:18,value:"18"},{id:19,value:"19"},{id:20,value:"20"},{id:21,value:"21"},{id:22,value:"22"},{id:23,value:"23"}];a.minutes=[{value:"00"},{value:"05"},
{value:"10"},{value:"15"},{value:"20"},{value:"25"},{value:"30"},{value:"35"},{value:"40"},{value:"45"},{value:"50"},{value:"55"}];d=new Date(a.entity.travel);k=d.getHours();d=d.getMinutes();c=new Date(a.entity.startTime);l=c.getHours();c=c.getMinutes();var e=new Date(a.entity.endTime),q=e.getHours(),e=e.getMinutes();a.selectedTravelHour=a.hours[k];a.selectedTravelMinute=a.minutes[d/5];a.selectedStartHour=a.hours[l];a.selectedStartMinute=a.minutes[c/5];a.selectedStopHour=a.hours[q];a.selectedStopMinute=
a.minutes[e/5];a.successCallback=function(){f.path("/inspections")};a.errorCallback=function(b){a.errorMessage=b};a.loadedAreas=!1;a.successAreaCallback=function(b){a.composedAreas=b;a.selectedArea=a.composedAreas[a.entity.area.id-1];a.loadedAreas=!0};a.reloadAreas=function(b){n.getComposedAreas(a.successAreaCallback,a.errorCallback)};new g;g=(new Date(a.entity.inspectionDate)).toString("MM/dd/yyyy");m.getLatestInspection(h.currentUserId,g,a.updateSuccessCallback,a.errorCallback);n.getComposedAreas(a.successAreaCallback,
a.errorCallback);a.saveReport=function(){var b=a.entity;b.inspectionDate=new Date(a.entity.inspectionDate);b.travel=new Date(b.inspectionDate.getTime());b.startTime=new Date(b.inspectionDate.getTime());b.endTime=new Date(b.inspectionDate.getTime());b.travel=b.travel.addHours(parseInt(a.selectedTravelHour.value));b.travel=b.travel.addMinutes(parseInt(a.selectedTravelMinute.value));b.startTime=b.startTime.addHours(parseInt(a.selectedStartHour.value));b.startTime=b.startTime.addMinutes(parseInt(a.selectedStartMinute.value));
b.endTime=b.endTime.addHours(parseInt(a.selectedStopHour.value));b.endTime=b.endTime.addMinutes(parseInt(a.selectedStopMinute.value));b.fined=parseInt(a.entity.fined);b.warnings=parseInt(a.entity.warnings);b.obliterated=parseInt(a.entity.obliterated);a.user=p.get({userId:h.currentUserId},function(c,d){b.guard={id:c.id,name:c.name};b.area={id:a.selectedArea.id,name:a.selectedArea.name};b.activityType={id:1,code:0,description:"-"};b.category={id:1,code:0,description:"inga lappar"};m.editInspection(b,
a.successCallback,a.errorCallback)},function(){alert("Error retreiving user")})};a.abortReportCreation=function(){f.path("/inspections")}}]);
